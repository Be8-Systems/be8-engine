const be8=function(){"use strict";const e=Object.freeze(["deriveKey","deriveBits"]),n="ECDH",t=Object.freeze({name:n,namedCurve:"P-256"}),r="jwk";function o(){return window.crypto.getRandomValues(new Uint8Array(16)).join("")}return class{#e="";constructor(e){this.#e=e}async generatePrivAndPubKey(){return window.crypto.subtle.generateKey(t,!0,e).then((function({privateKey:e,publicKey:n}){const t=[window.crypto.subtle.exportKey(r,n),window.crypto.subtle.exportKey(r,e)];return Promise.all(t)}))}async getDerivedKey(o,c){const i=window.crypto.subtle.importKey(r,o,t,!0,[]),d=window.crypto.subtle.importKey(r,c,t,!0,e);return Promise.all([i,d]).then((function([e,t]){return window.crypto.subtle.deriveKey({name:n,public:e},t,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}))}async encryptText(e,n){const t=(new TextEncoder).encode(n),r=o(),c={name:"AES-GCM",iv:(new TextEncoder).encode(r)};return window.crypto.subtle.encrypt(c,e,t).then((function(e){const n=new Uint8Array(e),t=String.fromCharCode.apply(null,n);return{cipherText:window.btoa(t),iv:r}}))}async decryptText(e,n,t){const r=window.atob(n),o=new Uint8Array([...r].map((e=>e.charCodeAt(0)))),c={name:"AES-GCM",iv:(new TextEncoder).encode(t)};return window.crypto.subtle.decrypt(c,e,o).then((function(e){return(new TextDecoder).decode(e)}))}async encryptImage(e,n){const t=(new TextEncoder).encode(n);return window.crypto.subtle.encrypt({name:"AES-GCM",iv:(new TextEncoder).encode(o())},e,t).then((function(e){return function(e){const n=new Uint8Array(e);let t="";for(let e=0;e<n.byteLength;e++)t+=String.fromCharCode(n[e]);return window.btoa(t)}(e)}))}async decryptImage(e,n){const t=window.atob(n),r=new Uint8Array([...t].map((e=>e.charCodeAt(0)))),c={name:"AES-GCM",iv:(new TextEncoder).encode(o())};return window.crypto.subtle.decrypt(c,e,r).then((function(e){return(new TextDecoder).decode(e)}))}}}();
